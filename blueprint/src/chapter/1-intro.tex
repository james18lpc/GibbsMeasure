\chapter{Specifications of random fields}

Let $S$ be a set, $(E, \mathcal{E})$ be a measurable space and $\nu$ a measure on $E$.

\begin{definition}[Specification]
    \label{def:specification}
    \uses{def:cylinder-event, def:kernel}
    \lean{Specification}
    \leanok

    A {\bf specification} is a family of kernels $\gamma : \Finset S \to \Ker_{\mathcal{F}_{S\setminus\Lambda}, \mathcal{E}^S}$ which is {\bf consistent}, in the sense that
    $$\forall \Lambda_1, \Lambda_2 \in \Finset(S), \Lambda_1 \subseteq \Lambda_2 \implies \gamma_{\Lambda_1} \circ_k \gamma_{\Lambda_2} = \gamma_{\Lambda_2}$$
\end{definition}

All specifications will be with parameter set $S$ and state space $(E, \mathcal{E})$ in this chapter.

\begin{definition}[Markov Specification]
    \label{def:markov-specification}
    \lean{Specification}
    \leanok
    \uses{def:specification}

    A specification $\gamma$ is a \textbf{Markov specification} if $\gamma_\Lambda$ is a probability kernel for every $\Lambda \in \Finset(S)$.
\end{definition}

\begin{definition}[Proper Specification]
    \label{def:proper-specification}
    \uses{def:specification, def:proper-kernel}
    \lean{Specification.IsProper}
    \leanok

    A specification $\gamma$ is \textbf{proper} if the kernel $\gamma_\Lambda$ is proper for every $\Lambda \in \Finset(S)$.
\end{definition}

\begin{definition}[Gibbs Measures]
    \label{def:gibbs-measure}
    \uses{def:specification}
    \lean{Specification.IsGibbsMeasure}
    \leanok
    Given a specification $\gamma$, the set of \textbf{Gibbs measures specified by $\gamma$} is defined as
    \begin{align}
        \mathcal{G}:\Gamma_{\mathcal{E}, S}&\to\text{Set}(\mathfrak{P}(E^S, \mathcal{E}^S))\\
        \gamma&\mapsto\left\{\nu\in\mathfrak{M}(E^S, \mathcal{E}^S)~\middle\vert~\gamma_\Lambda(A\mid\cdot)~\text{is a conditional expectation kernel w.r.t }\nu\text{ for each } A\in\mathcal{E}^S\text{ and }\Lambda\in\Finset(S)\right\}
    \end{align}
\end{definition}


\begin{lemma}[Characterization of Gibbs Measures]
    \label{lem:gibbs-measure-char}
    \uses{def:gibbs-measure, def:proper-specification}

    Let $\gamma$ be a {\it proper} specification with parameter set $S$ and state space $(E, \mathcal{E})$, and let $\nu\in\mathfrak{P}(E^S, \mathcal{E}^S)$. TFAE:
    \begin{enumerate}
        \item $\nu\in\mathcal{G}(\gamma)$.
        \item $\gamma_\Lambda\circ_k\nu=\nu$ for all $\Lambda\in\Finset(S)$.
        \item There is a cofinal subset $\mathcal{S}\subseteq\Finset(S)$ such that $\gamma_\Lambda\circ_k\nu=\nu$ for all $\Lambda\in\mathcal{S}$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    % \leanok

  See book.
\end{proof}

\begin{definition}[Independent Specification with Single Spin Distribution [ISSSD]]
    \label{def:ISSSD}
    \uses{def:juxtaposition}
    \lean{Specification.isssdFun}
    % \leanok

    The \textbf{Independent Specification with Single Spin Distribution $\nu$} is
    \begin{align}
        \ISSSD:\mathfrak{P}(E, \mathcal{E})&\to\Finset(S)\to\mathcal{E}^S\times E^S\to\overline{\mathbb{R}_{\geq0}}\\
        \nu&\mapsto\Lambda\mapsto(A\mid\omega)\mapsto\left(\nu^\Lambda\left(\text{super}_\omega^{-1}(A)\right)\right)
    \end{align}
    defines the \textbf{Independent Specification with Single Spin Distribution with $\nu$} (for each $\nu\in\mathfrak{P}(E, \mathcal{E})$), where $\nu^\Lambda$ is the usual product measure.
\end{definition}

\begin{lemma}[Strong Consistency of ISSSDs]
    \label{lem:isssd-strong-consistency}
    \uses{def:ISSSD}
    \lean{Specification.isssdFun_comp_isssdFun}
    \leanok

    $\ISSSD(\nu)$ is {\bf strongly consistent}, in the sense that
    $$\ISSSD(\nu)_{\Lambda_1} \circ_k \ISSSD(\nu)_{\Lambda_2} = \ISSSD(\nu)_{\Lambda_1 \cup \Lambda_2}$$
    for all $\Lambda_1, \Lambda_2 \in \Finset(S)$.
\end{lemma}
\begin{proof}
    % \leanok

  Immediate.
\end{proof}

\begin{definition}[ISSSDs are Specifications]
    \label{def:isssd-specification}
    \uses{lem:isssd-strong-consistency, def:specification}
    \lean{Specification.isssd}
    \leanok

    $\ISSSD(\nu)$ is a specification.
\end{definition}

\begin{lemma}[ISSSDs are Proper Specifications]
    \label{lem:isssd-proper-specification}
    \uses{def:isssd, def:proper-specification}
    \lean{Specification.IsProper.isssd}
    \leanok

    $\ISSSD(\nu)$ is a proper specification.
\end{lemma}
\begin{proof}
    \uses{def:isssd-specification}
    % \leanok

    We already know it's a specification. Properness is immediate.
\end{proof}

\begin{lemma}[Uniqueness of a Gibbs Measure Specified by an ISSSD]
    \label{lem:gibbs-measure-uniqueness}
    \uses{def:gibbs-measure, def:isssd-specification}

    There is at most one Gibbs measure specified by $\ISSSD(\nu)$.
\end{lemma}
\begin{proof}
    \uses{lem:isssd-proper-specification}
    % \leanok

    See book.
\end{proof}

\begin{lemma}[Existence of a Gibbs Measure Specified by an ISSSD]
    \label{lem:gibbs-measure-existence}
    \uses{def:gibbs-measure, def:product-probability-measure, def:isssd-specification}
    \lean{Specification.isGibbsMeasure_isssd_productMeasure}
    % \leanok

    The product measure $\nu^S$ is a Gibbs measure specified by $\ISSSD(\nu)$.
\end{lemma}
\begin{proof}
    % \leanok

   Immediate.
\end{proof}

\begin{definition}[Modification]
    \label{def:modification}
    \uses{def:specification}
    \lean{Specification.IsModification, Specification.modified}
    \leanok

    A {\bf modification of $\gamma$} is a family
    $$\rho : \Finset(S) \to \Omega \to [0, \infty[$$
    such that the corresponding family of kernels $\rho\nu$ is a specification.
\end{definition}

\begin{lemma}[Modification of a modification]
    \label{lem:modification-modification}
    \uses{def:modification}
    \lean{Specification.modified_modified}
    \leanok

    Modifying a specification $\gamma$ by $\rho_1$ then $\rho_2$ is the same as modifying it by their product.
\end{lemma}
\begin{proof}
    % \uses{}
    % \leanok

    TODO for James ;)
\end{proof}

% Currently skipping the definition of positive modifications because it looks a bit dumb

\begin{lemma}[A modification of a proper specification is proper]
    \label{lem:modification-proper}
    \uses{def:modification, def:proper-specification}
    \lean{Specification.IsProper.modified}
    \leanok

    If $\gamma$ is a specification and $\rho$ a modification of $\gamma$, then $\rho\gamma$ is a proper specification.
\end{lemma}
\begin{proof}
    \uses{lem:proper-kernel-integral}
    \leanok

    For all $\Lambda \in \Finset(S)$, $A \in \mathcal E^S$, $B \in \mathcal{F}_{S\setminus\Lambda}$, $\eta : S \to E$, we want to prove
    $$(\rho\gamma)_\Lambda(A \inter B | \eta) = 1_B(\eta) (\rho\gamma)_\Lambda(A B | \eta)$$
    Expanding out, this is equivalent to
    $$\int_{\zeta \in A \inter B} \rho_\Lambda(\zeta)\ d(\gamma_\Lambda(\eta)) = 1_B(\eta) \int_{\zeta \in A} \rho_\Lambda(\zeta)\ d(\gamma_\Lambda(\eta))$$
    which is true by Lemma \ref{lem:proper-kernel-integral} with $f = 1_A\rho_\Lambda$, $g = 1_B$.
\end{proof}
